# GPU override for AMD ROCm (primary LLM GPU) + Intel (voice GPU).
# This is the default for Derek's setup:
#   GPU 0 (AMD RX 7900 XT, 20GB) → LLM
#   GPU 1 (Intel Arc B580, 12GB)  → Orpheus TTS (via Orpheus-FastAPI)
#
# Usage: docker compose -f docker-compose.yml -f docker-compose.gpu-amd.yml up -d

services:
  # AMD ROCm for main LLM
  atlas-ollama:
    image: ollama/ollama:rocm
    devices:
      - /dev/kfd:/dev/kfd
      - /dev/dri/card1:/dev/dri/card1
      - /dev/dri/renderD129:/dev/dri/renderD129
    group_add:
      - video

  # Intel Arc XPU for Orpheus SNAC decoder
  atlas-orpheus:
    devices:
      - /dev/dri:/dev/dri
    group_add:
      - video

  # Intel Arc for llama.cpp Orpheus inference
  atlas-llama-voice:
    devices:
      - /dev/dri:/dev/dri
    group_add:
      - video
